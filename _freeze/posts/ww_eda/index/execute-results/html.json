{
  "hash": "cc44ebe3c67ff1e844a5711530cd3590",
  "result": {
    "markdown": "---\ntitle: \"Exploratory Data Analysis of SARS-CoV-2 in Cook County Wastewater\"\nauthor: \"Daniel P. Hall Riggins, MD\"\ndate: \"2022-11-12\"\ncategories: [chicago, epidemiology, covid]\ncode-fold: true\nexecute: \n  warning: false\n  error: false\n---\n\n\n## Rationale\n\nI am working on a project to support Cook County Department of Public Health with wastewater surveillance of SARS-CoV-2. We want to detect surges of viral copies in wastewater and see if those surges can act as early warnings for surges in hospital cases of COVID-19. In this post, I will perform some preliminary exploratory data analysis of the data.\n\n## Dataset and Prep\n\nThe data was derived from the CDC's National Wastewater Surveillance System. Please see this [git commit](https://github.com/andtheWings/sars_wastewater_in_cook_county/commit/c513908b2830a00dcb54f3927289e44578804ff6) for a specification of the data preparation pipeline I performed using the {[targets](https://docs.ropensci.org/targets/)} package. \n\nHere is a glimpse of the data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(timetk)\nlibrary(tmap)\n\nww_data <- arrow::read_parquet(here::here(\"data\", \"ww_cook_county.parquet\")) \n\nglimpse(ww_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 629\nColumns: 14\n$ date                              <date> 2021-11-01, 2021-11-01, 2021-11-03,…\n$ day_num                           <dbl> 610, 610, 612, 612, 617, 624, 624, 6…\n$ sample_collect_date_time          <dttm> 2021-11-01 03:00:00, 2021-11-01 03:…\n$ wwtp_name                         <chr> \"mwrdgc calumet wrp\", \"mwrdgc o'brie…\n$ short_name                        <chr> \"calumet\", \"obrien\", \"calumet\", \"obr…\n$ display_name                      <chr> \"Calumet, South Suburbs and Chicago\"…\n$ population_served                 <dbl> 1134897, 1263110, 1134897, 1263110, …\n$ longitude                         <dbl> -87.68732, -87.88357, -87.68732, -87…\n$ latitude                          <dbl> 41.81193, 42.05788, 41.81193, 42.057…\n$ pcr_target_avg_conc               <dbl> 9910.641, 58259.228, 2040.000, 19864…\n$ pcr_target_units                  <chr> \"copies/l wastewater\", \"copies/l was…\n$ rec_eff_percent                   <dbl> 0.000, 0.015, 0.000, 6.455, 3.055, 6…\n$ flow_rate                         <dbl> 354, 333, 354, 333, 354, 333, 354, 3…\n$ M_viral_copies_per_day_per_person <dbl> 0.000000000, 0.008721118, 0.00000000…\n```\n:::\n:::\n\n\nLaboratories report results as concentration of viral copies recovered per liter of wastewater at each sampling site. In order to enable standardized comparison of samples across different sampling sites, the CDC recommends standardizing by:\n\n- Efficiency of viral recovery during the sampling process (variable `rec_eff_percent`). This is estimated by spiking wastewater with a known quantity of a different virus and seeing what proportion is recovered.\n- Flow rate of wastewater at the sampling site (variable `flow_rate` in millions of gallons per day).\n- Number of people supplying waste to the sewershed (variable `population_served`).\n\nAfter standardizing by all these variables, the measurements units convert to million viral copies per day per person (variable `M_viral_copies_per_day_per_person`).\n\nThere are 7 wastewater treatment plants at which SARS-CoV-2 is sampled in Cook County:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nww_data_locations <-\n    ww_data |>  \n    select(display_name) |> \n    distinct() |> \n    arrange(display_name)\n\nww_data_locations\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 8 × 1\n  display_name                          \n  <chr>                                 \n1 Calumet, South Suburbs and Chicago    \n2 Egan, Far Northwest Suburbs           \n3 Hanover Park, Far Northwest Suburbs   \n4 Kirie, Mid Northwest Suburbs          \n5 Lemont, Far Southwest Suburbs         \n6 O'Brien, Northeast Suburbs and Chicago\n7 Stickney (1), West Suburbs and Chicago\n8 Stickney (2), West Suburbs and Chicago\n```\n:::\n:::\n\n\nHere are the locations on the map:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nww_data_locations <- \n    ww_data |>  \n    select(display_name) |> \n    distinct() |> \n    arrange(display_name) |> \n    # CDC-provided long/lats are not accurate\n    mutate(\n        longitude = c(-87.606416, -88.037690, -88.138314, -87.936888, -87.998061, -87.717100, -87.766175, -87.766175),\n        latitude = c(41.662910, 42.019824, 41.999846, 42.021035, 41.678252, 42.020932, 41.817061, 41.817061)\n    ) |> \n    sf::st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326)\n    \ntmap_mode(\"view\")\n\nww_data_locations |> \n    select(display_name) |> \n    distinct() |> \n    tm_shape() + \n    tmap::tm_markers() \n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-6f54515331b888be43a2\" style=\"width:100%;height:464px;\" class=\"leaflet html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-6f54515331b888be43a2\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"createMapPane\",\"args\":[\"tmap401\",401]},{\"method\":\"addProviderTiles\",\"args\":[\"Esri.WorldGrayCanvas\",null,\"Esri.WorldGrayCanvas\",{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"OpenStreetMap\",null,\"OpenStreetMap\",{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"Esri.WorldTopoMap\",null,\"Esri.WorldTopoMap\",{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"addMarkers\",\"args\":[[41.66291,42.019824,41.999846,42.021035,41.678252,42.020932,41.817061,41.817061],[-87.606416,-88.03769,-88.138314,-87.936888,-87.998061,-87.7171,-87.766175,-87.766175],{\"iconUrl\":{\"data\":\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=\",\"index\":[0,0,0,0,0,0,0,0]},\"iconWidth\":[25,25,25,25,25,25,25,25],\"iconHeight\":[41,41,41,41,41,41,41,41],\"iconAnchorX\":[12,12,12,12,12,12,12,12],\"iconAnchorY\":[41,41,41,41,41,41,41,41]},[\"Calumet..South.Suburbs.and.Chicago\",\"Egan..Far.Northwest.Suburbs\",\"Hanover.Park..Far.Northwest.Suburbs\",\"Kirie..Mid.Northwest.Suburbs\",\"Lemont..Far.Southwest.Suburbs\",\"O.Brien..Northeast.Suburbs.and.Chicago\",\"Stickney..1...West.Suburbs.and.Chicago\",\"Stickney..2...West.Suburbs.and.Chicago\"],\"distinct(select(ww_data_locations, display_name))\",{\"interactive\":true,\"draggable\":false,\"keyboard\":true,\"title\":\"\",\"alt\":\"\",\"zIndexOffset\":0,\"opacity\":1,\"riseOnHover\":false,\"riseOffset\":250,\"pane\":\"tmap401\"},[\"<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\\/style><div style=\\\"max-height:25em;padding-right:0px;\\\"><table>\\n\\t\\t\\t   <thead><tr><th colspan=\\\"2\\\"><b>Calumet, South Suburbs and Chicago<\\/b><\\/th><\\/thead><\\/tr><tr><td style=\\\"color: #888888;\\\"><nobr>display_name<\\/nobr><\\/td><td align=\\\"right\\\"><nobr>Calumet, South Suburbs and Chicago<\\/nobr><\\/td><\\/tr><\\/table><\\/div>\",\"<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\\/style><div style=\\\"max-height:25em;padding-right:0px;\\\"><table>\\n\\t\\t\\t   <thead><tr><th colspan=\\\"2\\\"><b>Egan, Far Northwest Suburbs<\\/b><\\/th><\\/thead><\\/tr><tr><td style=\\\"color: #888888;\\\"><nobr>display_name<\\/nobr><\\/td><td align=\\\"right\\\"><nobr>Egan, Far Northwest Suburbs<\\/nobr><\\/td><\\/tr><\\/table><\\/div>\",\"<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\\/style><div style=\\\"max-height:25em;padding-right:0px;\\\"><table>\\n\\t\\t\\t   <thead><tr><th colspan=\\\"2\\\"><b>Hanover Park, Far Northwest Suburbs<\\/b><\\/th><\\/thead><\\/tr><tr><td style=\\\"color: #888888;\\\"><nobr>display_name<\\/nobr><\\/td><td align=\\\"right\\\"><nobr>Hanover Park, Far Northwest Suburbs<\\/nobr><\\/td><\\/tr><\\/table><\\/div>\",\"<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\\/style><div style=\\\"max-height:25em;padding-right:0px;\\\"><table>\\n\\t\\t\\t   <thead><tr><th colspan=\\\"2\\\"><b>Kirie, Mid Northwest Suburbs<\\/b><\\/th><\\/thead><\\/tr><tr><td style=\\\"color: #888888;\\\"><nobr>display_name<\\/nobr><\\/td><td align=\\\"right\\\"><nobr>Kirie, Mid Northwest Suburbs<\\/nobr><\\/td><\\/tr><\\/table><\\/div>\",\"<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\\/style><div style=\\\"max-height:25em;padding-right:0px;\\\"><table>\\n\\t\\t\\t   <thead><tr><th colspan=\\\"2\\\"><b>Lemont, Far Southwest Suburbs<\\/b><\\/th><\\/thead><\\/tr><tr><td style=\\\"color: #888888;\\\"><nobr>display_name<\\/nobr><\\/td><td align=\\\"right\\\"><nobr>Lemont, Far Southwest Suburbs<\\/nobr><\\/td><\\/tr><\\/table><\\/div>\",\"<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\\/style><div style=\\\"max-height:25em;padding-right:0px;\\\"><table>\\n\\t\\t\\t   <thead><tr><th colspan=\\\"2\\\"><b>O'Brien, Northeast Suburbs and Chicago<\\/b><\\/th><\\/thead><\\/tr><tr><td style=\\\"color: #888888;\\\"><nobr>display_name<\\/nobr><\\/td><td align=\\\"right\\\"><nobr>O'Brien, Northeast Suburbs and Chicago<\\/nobr><\\/td><\\/tr><\\/table><\\/div>\",\"<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\\/style><div style=\\\"max-height:25em;padding-right:0px;\\\"><table>\\n\\t\\t\\t   <thead><tr><th colspan=\\\"2\\\"><b>Stickney (1), West Suburbs and Chicago<\\/b><\\/th><\\/thead><\\/tr><tr><td style=\\\"color: #888888;\\\"><nobr>display_name<\\/nobr><\\/td><td align=\\\"right\\\"><nobr>Stickney (1), West Suburbs and Chicago<\\/nobr><\\/td><\\/tr><\\/table><\\/div>\",\"<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\\/style><div style=\\\"max-height:25em;padding-right:0px;\\\"><table>\\n\\t\\t\\t   <thead><tr><th colspan=\\\"2\\\"><b>Stickney (2), West Suburbs and Chicago<\\/b><\\/th><\\/thead><\\/tr><tr><td style=\\\"color: #888888;\\\"><nobr>display_name<\\/nobr><\\/td><td align=\\\"right\\\"><nobr>Stickney (2), West Suburbs and Chicago<\\/nobr><\\/td><\\/tr><\\/table><\\/div>\"],null,true,null,[\"Calumet, South Suburbs and Chicago\",\"Egan, Far Northwest Suburbs\",\"Hanover Park, Far Northwest Suburbs\",\"Kirie, Mid Northwest Suburbs\",\"Lemont, Far Southwest Suburbs\",\"O'Brien, Northeast Suburbs and Chicago\",\"Stickney (1), West Suburbs and Chicago\",\"Stickney (2), West Suburbs and Chicago\"],{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addLayersControl\",\"args\":[[\"Esri.WorldGrayCanvas\",\"OpenStreetMap\",\"Esri.WorldTopoMap\"],\"distinct(select(ww_data_locations, display_name))\",{\"collapsed\":true,\"autoZIndex\":true,\"position\":\"topleft\"}]}],\"limits\":{\"lat\":[41.66291,42.021035],\"lng\":[-88.138314,-87.606416]},\"fitBounds\":[41.66291,-88.138314,42.021035,-87.606416,[]]},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.5.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/jquery-1.12.4/jquery.min.js\"></script>\n<link href=\"../../site_libs/leaflet-1.3.1/leaflet.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/leaflet-1.3.1/leaflet.js\"></script>\n<link href=\"../../site_libs/leafletfix-1.0.0/leafletfix.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/proj4-2.6.2/proj4.min.js\"></script>\n<script src=\"../../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js\"></script>\n<link href=\"../../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/leaflet-binding-2.1.1/leaflet.js\"></script>\n<script src=\"../../site_libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js\"></script>\n<script src=\"../../site_libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js\"></script>\n<link href=\"../../site_libs/leaflet-markercluster-1.0.5/MarkerCluster.css\" rel=\"stylesheet\" />\n<link href=\"../../site_libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js\"></script>\n<script src=\"../../site_libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js\"></script>\n<script src=\"../../site_libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}